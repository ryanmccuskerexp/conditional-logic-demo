<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Confirmation Logic Builder</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <button id="open-modal-btn">Configure Confirmation</button>
  <div id="modal-overlay" class="modal-overlay">
    <div class="modal-container">

      <header class="modal-header">
        <h2>Form Details Renderer</h2>
        <button id="close-modal-btn" class="close-btn">âœ•</button>
      </header>

      <div class="modal-body">

        <!-- TABS -->
        <nav class="tabs">
          <button class="tab"       data-target="details-content">Details</button>
          <button class="tab"       data-target="form-content">Form</button>
          <button class="tab"       data-target="design-content">Design</button>
          <button class="tab active" data-target="confirmation-content">Confirmation</button>
          <button class="tab"       data-target="hidden-content">Additional Hidden Fields</button>
        </nav>

        <!-- DETAILS PANEL -->
        <div id="details-content" class="tab-content" style="display:block;">
          <!-- â€¦ -->
        </div>

        <!-- FORM PANEL -->
        <div id="form-content" class="tab-content" style="display:none;">
          <div class="field-group">
            <p>Are you a current Experian Customer?*</p>
            <label><input type="radio" name="experianCustomer" value="yes"> Yes</label>
            <label><input type="radio" name="experianCustomer" value="no"> No</label>
          </div>
          <div class="field-group">
            <p>How many employees does your company have?*</p>
            <label><input type="radio" name="employeesCount" value="â‰¤100"> 100 employees or less</label>
            <label><input type="radio" name="employeesCount" value=">100"> 100 employees or more</label>
          </div>
          <div class="field-group">
            <p>Do you have permissible purpose?*</p>
            <label><input type="radio" name="permissiblePurpose" value="yes"> Yes</label>
            <label><input type="radio" name="permissiblePurpose" value="no"> No</label>
          </div>
          <div class="field-group">
            <label>Country *</label>
            <select name="country">
              <option>United States</option>
              <option>Canada</option>
              <option>United Kingdom</option>
              <option>Australia</option>
              <option>Germany</option>
              <option>France</option>
              <option>India</option>
              <option>Brazil</option>
              <option>Japan</option>
              <option>Mexico</option>
              <!-- add more here if you like -->
            </select>
          </div>
          <div class="field-group"><label>Email *</label><input type="email"></div>
          <div class="field-group"><label>First Name *</label><input type="text"></div>
          <div class="field-group"><label>Last Name *</label><input type="text"></div>
          <div class="field-group"><label>Company *</label><input type="text"></div>
          <div class="field-group"><label>Phone *</label><input type="tel"></div>
        </div>

        <!-- DESIGN PANEL -->
        <div id="design-content" class="tab-content" style="display:none;">
          <!-- â€¦ -->
        </div>

        <!-- CONFIRMATION PANEL -->
        <div id="confirmation-content" class="tab-content" style="display:none;">
          <!-- CONFIRMATION TARGET -->
          <div class="field-group">
            <label for="confirmation-target">Confirmation target *</label>
            <select id="confirmation-target">
              <option value="redirect">Redirect</option>
              <option value="modal">Modal</option>
              <option value="download">Download</option>
            </select>
          </div>

          <!-- DEFAULT PAGE (dynamic) -->
          <div class="field-group" id="default-page-group">
            <label for="default-input" id="default-label">Choose default confirmation page *</label>
            <input type="text" id="default-input" placeholder="https://">
          </div>

          <!-- CONDITIONAL LOGIC TOGGLE -->
          <label class="switch">
            <input type="checkbox" id="toggle-conditional">
            <span class="slider"></span>
            <span class="label">Conditional Logic</span>
          </label>

          <!-- CONDITIONAL BUILDER (hidden until toggle) -->
          <div id="conditional-builder">
            <div id="builder-container"></div>
            <button id="add-rule-btn" class="add-btn">+ Add New Rule</button>
          </div>
        </div>

        <!-- ADDITIONAL HIDDEN FIELDS PANEL -->
        <div id="hidden-content" class="tab-content" style="display:none;">
          <!-- â€¦ -->
        </div>

      </div>

      <footer class="modal-footer">
        <button id="cancel-btn">Cancel</button>
        <button id="save-btn">Save</button>
      </footer>

    </div>
  </div>

  <script src="js/app.js"></script>
  <script>
    // modal open/close
    const overlay = document.getElementById('modal-overlay');
    document.getElementById('open-modal-btn')
      .addEventListener('click', ()=> overlay.classList.add('open'));
    document.getElementById('close-modal-btn')
      .addEventListener('click', ()=> overlay.classList.remove('open'));
    document.getElementById('cancel-btn')
      .addEventListener('click', ()=> overlay.classList.remove('open'));

    // show/hide conditional-builder
    const toggle = document.getElementById('toggle-conditional');
    const cond   = document.getElementById('conditional-builder');
    cond.style.display = 'none';   // start hidden
    toggle.addEventListener('change', () => {
      cond.style.display = toggle.checked ? 'block' : 'none';
    });

    // dynamic default-page swapping
    const topSelect    = document.getElementById('confirmation-target');
    const defaultGroup = document.getElementById('default-page-group');

    function makePathChooser(accept, placeholder) {
      const wrap = document.createElement('div');
      wrap.style.display = 'flex'; wrap.style.gap = '.5em';

      const txt = document.createElement('input');
      txt.type = 'text'; txt.readOnly = true;
      txt.placeholder = placeholder; txt.style.flex = '1';

      const btn = document.createElement('button');
      btn.type = 'button'; btn.textContent = 'ðŸ“';
      btn.onclick = () => hid.click();
      btn.className = 'browse-btn';

      const hid = document.createElement('input');
      hid.type = 'file'; hid.accept = accept; hid.style.display = 'none';
      hid.onchange = () => txt.value = hid.files[0]?.name || '';

      wrap.append(txt, btn, hid);
      return wrap;
    }

    function updateDefaultField() {
      defaultGroup.innerHTML = '';
      let lbl = document.createElement('label');
      lbl.htmlFor = 'default-input';

      let widget;
      if (topSelect.value === 'redirect') {
        lbl.textContent = 'Choose default confirmation page *';
        widget = document.createElement('input');
        widget.type = 'text'; widget.id = 'default-input';
        widget.placeholder = 'https://';
      }
      else if (topSelect.value === 'modal') {
        lbl.textContent = 'Select default modal component';
        widget = makePathChooser('.html', 'Select .html fileâ€¦');
      }
      else { // download
        lbl.textContent = 'Choose default download file';
        widget = makePathChooser('.zip', 'Select .zip fileâ€¦');
      }

      defaultGroup.append(lbl, widget);
    }

    // init + re-run on change
    updateDefaultField();
    topSelect.addEventListener('change', () => {
      updateDefaultField();
      // also fire the same event so app.js re-locks all row inputs
      topSelect.dispatchEvent(new Event('change'));
    });

    // TAB SWITCHING
    document.querySelectorAll('.tabs .tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // activate tab
        document.querySelectorAll('.tabs .tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        // show panel
        document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
        document.getElementById(tab.dataset.target).style.display = 'block';
      });
    });
  </script>
</body>
</html>
